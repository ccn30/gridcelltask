knitr::opts_chunk$set(echo = TRUE)
# Stats on gridcode metrics
require(ggplot2)
require(dplyr)
require(tibble)
require(readr)
require(tidyr)
# includes demographics
tgridcode = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_outX_totalresults.csv');
tgridcodev2 = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_outX_totalresults_v2.csv');
tgridtaskin = read.csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCATbehaviourresults.csv');
#demographics = read.csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/demographics.csv')
strucdata = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/tSNR.csv')
######### TIDY DATA #############
# recode subject to factor
tgridcode[,1] <- lapply(tgridcode[,1],factor)
strucdata[,1:2] <- lapply(strucdata[,1:2],factor)
# recode age cont to cat in tgridcodein
tgridcode2 <- tgridcode %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# remove subject 29358 due to motion
tgridcodein <- tgridcode2[-8,]
tgridcodev2 <- tgridcodev2[-8,]
rm(tgridcode,tgridcode2)
# make second tgridcodev2 variable for models 8,9,10,11
tgridcodeinv2 <- bind_cols(select(tgridcodein,Subject,Age,Age_Group,Gender,contains("out03"),contains("out04")),select(tgridcodev2,contains("out08"),contains("out09"),contains("outw10"),contains("outy11")))
rm(tgridcodev2)
# get magnitude
grid.mag.untidy <- tgridcodein %>% select(Subject,Age,Age_Group,Gender,starts_with("GCmagnitude"))
grid.magv2.untidy <- tgridcodeinv2 %>% select(Subject,Age,Age_Group,Gender,starts_with("GCmagnitude"))
grid.mag <- grid.mag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
grid.magv2 <- grid.magv2.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
grid.mag.sep <- separate(grid.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
grid.magv2.sep <- separate(grid.magv2,Model,c(NA,"Run",NA,NA,"Model"),"_")
rm(grid.mag,grid.magv2,grid.mag.untidy,grid.magv2.untidy)
# get spatial stability
#Rayleigh Z
grid.sStability.z.untidy <- tgridcodein %>% select(Subject,Age,Age_Group,Gender,starts_with("sStability_zRay"))
grid.sStability.z <- grid.sStability.z.untidy %>% gather(Model,Grid_sStabilityZ,starts_with("sStability"))
grid.sStability.z.sep <- separate(grid.sStability.z,Model,c(NA,NA,"Run",NA,NA,"Model"),"_")
#Rayleigh p
grid.sStability.p.untidy <- tgridcodein %>% select(Subject,Age,Age_Group,Gender,starts_with("sStability_pRay"))
grid.sStability.p <- grid.sStability.p.untidy %>% gather(Model,Grid_sStabilityP,starts_with("sStability"))
grid.sStability.p.sep <- separate(grid.sStability.p,Model,c(NA,NA,"Run",NA,NA,"Model"),"_")
rm(grid.sStability.p.untidy,grid.sStability.z.untidy)
# get temporal stability
grid.tStability.untidy <- tgridcodein %>% select(Subject,Age,Age_Group,Gender,starts_with("tStability"))
grid.tStabilityv2.untidy <- tgridcodeinv2 %>% select(Subject,Age,Age_Group,Gender,starts_with("tStability"))
grid.tStability <- grid.tStability.untidy %>% gather(Model,Grid_tStability,starts_with("tStability"))
grid.tStabilityv2 <- grid.tStabilityv2.untidy %>% gather(Model,Grid_tStability,starts_with("tStability"))
grid.tStability.sep <- separate(grid.tStability,Model,c(NA,NA,"RunComparison",NA,NA,"Model"),"_")
grid.tStabilityv2.sep <- separate(grid.tStabilityv2,Model,c(NA,NA,"RunComparison",NA,NA,"Model"),"_")
rm(grid.tStability.untidy,grid.tStabilityv2.untidy,grid.tStability,grid.tStabilityv2)
select(tgridcodein,Subject,Age,Age_Group,Gender)
head(grid.mag.sep)
head(grid.tStability.sep)
head(grid.sStability.z)
head(grid.sStability.p)
gridmagav <- filter(grid.mag.sep,Run == "allRuns")
ggplot(gridmagav, aes(Model,Grid_Magnitude,fill = Model)) +
geom_boxplot() +
labs(title = "Grid magnitude average across 3 runs, all subjects \nMain models vs bilateral control models")
lm.magAv <- lm(data = gridmagav,Grid_Magnitude~Model)
anova(lm.magAv)
ggplot(gridmagav, aes(y=Grid_Magnitude,x=Model,fill = Model)) +
geom_boxplot() +
facet_wrap(~Age_Group)
lm.magAvAge <- lm(data = gridmagav, Grid_Magnitude~Model + Age + Model:Age)
anova(lm.magAvAge)
gridmagav.01 <- gridmagav %>% filter(Model == "out01")
lm.gridmagav.age.01 <- lm(data = gridmagav.01,Grid_Magnitude~Age)
anova(lm.gridmagav.age.01)
gridmagav.03 <- gridmagav %>% filter(Model == "out03")
lm.gridmagav.age.03 <- lm(data = gridmagav.03,Grid_Magnitude~Age)
anova(lm.gridmagav.age.03)
ggplot(gridmagav.03,aes(Age,Grid_Magnitude)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="Left EC magnitude effect of age")
gridmagav.04 <- gridmagav %>% filter(Model == "out04")
lm.gridmagav.age.04 <- lm(data = gridmagav.04,Grid_Magnitude~Age)
anova(lm.gridmagav.age.04)
ggplot(gridmagav.04,aes(Age,Grid_Magnitude)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="right EC magnitude effect of age")
grid.mag.runs <- grid.mag.sep %>% filter(Run != "allRuns")
ggplot(grid.mag.runs, aes(y=Grid_Magnitude,x=Model,fill = Run)) +
geom_boxplot(stat = "boxplot", position = position_dodge()) +
labs(title = "Grid magnitude across runs, all subjects for each model \n")
lm.magRuns <- lm(data = grid.mag.runs, Grid_Magnitude~Model + Run + Model:Run)
anova(lm.magRuns)
gridmag.runs01 <- grid.mag.runs %>% filter(Model == "out01")
lm.gridmag.runs01 <- lm(data = gridmag.runs01, Grid_Magnitude~Run)
anova(lm.gridmag.runs01)
gridmag.runs03 <- grid.mag.runs %>% filter(Model == "out03")
lm.gridmag.runs03 <- lm(data = gridmag.runs03, Grid_Magnitude~Run)
anova(lm.gridmag.runs03)
gridmag.runs04 <- grid.mag.runs %>% filter(Model == "out04")
lm.gridmag.runs04 <- lm(data = gridmag.runs04, Grid_Magnitude~Run)
anova(lm.gridmag.runs04)
lm.gridmag.runs.age03 <- lm(data = gridmag.runs03,Grid_Magnitude~Run + Run:Age)
anova(lm.gridmag.runs.age03)
lm.gridmag.runs.age04 <- lm(data = gridmag.runs04,Grid_Magnitude~Run + Age_Group + Run:Age_Group)
anova(lm.gridmag.runs.age04)
#gridmag.runs01.young <- gridmag.runs01 %>% filter(Age_Group == "Young")
lm.gridmagruns.01<- lm(data = gridmag.runs01, Grid_Magnitude~Run + Age + Run:Age)
anova(lm.gridmagruns.01)
ggplot(gridmag.runs01, aes(y=Grid_Magnitude,x=Subject,fill = Run)) +
geom_col(position=position_dodge()) +
labs(title = "Individual subjects' grid magnitude for Model 01 Bilateral \n") +
facet_wrap(~Age_Group,scale="free_x")
ggplot(gridmag.runs03, aes(y=Grid_Magnitude,x=Subject,fill = Run)) +
geom_col(position=position_dodge()) +
labs(title = "Individuals subjects' grid magnitude for Model 03 Left") +
facet_grid(~Age_Group,scales="free_x")
ggplot(gridmag.runs04, aes(y=Grid_Magnitude,x=Subject,fill = Run)) +
geom_col(position=position_dodge()) +
labs(title = "Individual subjects' grid magnitude for Model 04 Right \n") +
facet_wrap(~Age_Group,scales="free_x")
grid.magv2.runs <- grid.magv2.sep %>% filter(Run != "allRuns")
right <- c("out04","outw10","outy11")
left <- c("out03","out08","out09")
grid.magv2.runsLR <- grid.magv2.runs %>% mutate(Side = factor(case_when(Model %in% right ~ "RightEC", Model %in% left ~ "LeftEC")))
ggplot(grid.magv2.runsLR, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(position = position_dodge()) +
facet_wrap(~Side,scales = "free_x") +
labs(title = "Effect of model on magnitude for left and right EC, all subjects \n")
grid.magavv2.model <- grid.magv2.sep %>% filter(Run == "allRuns")
grid.magavv2.model.right <- grid.magavv2.model %>%  mutate(Side = factor(case_when(Model %in% right ~ "RightEC", Model %in% left ~ "LeftEC"))) %>% filter(Side == "RightEC")
lm.grid.magavv2.model.right<- lm(data = grid.magavv2.model.right,Grid_Magnitude~Model + Age + Model:Age)
anova(lm.grid.magavv2.model.right)
grid.magav2.right.ttest.4v10 <- filter(grid.magavv2.model.right,Model != "outy11")
t.test(Grid_Magnitude~Model,data=grid.magav2.right.ttest.4v10,alternative="two.sided",var.equal=TRUE)
grid.magav2.right.ttest.4v11 <- filter(grid.magavv2.model.right,Model != "outw10")
t.test(Grid_Magnitude~Model,data=grid.magav2.right.ttest.4v11,alternative="two.sided",var.equal=TRUE)
ggplot(grid.magavv2.model.right,aes(Age,Grid_Magnitude)) +
geom_jitter() +
facet_wrap(~Model) +
geom_smooth(method=lm) +
labs(title="Right EC grid-magnitude relationships with age for main and control models")
grid.magavv2.model.left <- grid.magavv2.model %>%  mutate(Side = factor(case_when(Model %in% right ~ "RightEC", Model %in% left ~ "LeftEC"))) %>% filter(Side == "LeftEC")
lm.grid.magavv2.model.left<- lm(data = grid.magavv2.model.left,Grid_Magnitude~Model + Age + Model:Age)
anova(lm.grid.magavv2.model.left)
ggplot(grid.magavv2.model.left,aes(Age,Grid_Magnitude)) +
geom_jitter() +
facet_wrap(~Model) +
geom_smooth(method=lm) +
labs(title="Left EC grid-magnitude relationships with age for main and control models")
grid.tstab.runs <- filter(grid.tStability.sep, !grepl("allRunsAvg",RunComparison))
ggplot(grid.tstab.runs, aes(Model,Grid_tStability,fill = RunComparison)) +
geom_boxplot(position = position_dodge()) +
labs(title = "% of voxels stable between runs, all subjects for each model \n")
lm.tstab.runs <- lm(data = grid.tstab.runs, Grid_tStability~Model + RunComparison + Model:RunComparison)
anova(lm.tstab.runs)
ggplot(grid.tstab.runs, aes(Model,Grid_tStability,fill = RunComparison)) +
geom_boxplot(position = position_dodge()) +
facet_wrap(~Age_Group)
grid.tstab.runs01 <- grid.tstab.runs %>% filter(Model == "out01")
lm.gridtstab.allruns.age.01 <- lm(data = grid.tstab.runs01, Grid_tStability~Age)
anova(lm.gridtstab.allruns.age.01)
grid.tstab.runs03 <- filter(grid.tstab.runs, Model == "out03")
lm.gridtstab.allruns.age.03 <- lm(data= grid.tstab.runs03, Grid_tStability~Age)
anova(lm.gridtstab.allruns.age.03)
grid.tstab.runs04 <- filter(grid.tstab.runs, Model == "out04")
lm.gridtstab.allruns.age.04 <- lm(data = grid.tstab.runs04, Grid_tStability~Age)
anova(lm.gridtstab.allruns.age.04)
grid.tstab.main <- rbind(grid.tstab.runs01,grid.tstab.runs03,grid.tstab.runs04)
ggplot(grid.tstab.main,aes(Age,Grid_tStability,colour=RunComparison)) +
geom_jitter() +
geom_smooth(method = lm,alpha=0.25) +
facet_wrap(~Model) +
labs(title="Temporal stability significantly associated with age for right EC only (04)")
# make new column coding for significant p value or not
freq.sStability.p <- grid.sStability.p.sep %>%
filter(Run == "allRunsAvg") %>%
mutate(FreqSig=cut(Grid_sStabilityP,breaks = c(-Inf, 0.05, Inf), labels = c("<0.05",">0.05")))
ggplot(freq.sStability.p, aes(FreqSig, ..count..)) +
geom_bar(aes(fill = Model), position = "dodge") +
facet_wrap(~Age_Group) +
labs(title = "Frequency of subjects showing significant non-uniformity split by age\n")
grid.sStability.z.av <- filter(grid.sStability.z.sep, Run == "allRunsAvg")
ggplot(grid.sStability.z.av,aes(Age,Grid_sStabilityZ)) +
geom_jitter() +
geom_smooth(method=lm,alpha=0.2) +
facet_wrap(~Model) +
labs(title = "Rayleigh Z value association with age per model")
lm.gridsStab.age.model <- lm(data=grid.sStability.z.av,Grid_sStabilityZ~Age + Model + Age:Model)
anova(lm.gridsStab.age.model)
strucdata
tgridtaskin <- tgridtaskin[-8,]
tgridtaskin
gridmagav.right <- filter(grid.magavv2.model,Model=="out04")
gridmagav.left <- filter(grid.magavv2.model,Model=="out03")
volmagall <- left_join(strucdata,grid.magv2.runsLR,by = c("Subject","Side"))
volmag.right <- bind_cols(filter(strucdata,Side=="RightEC"),select(gridmagav.right,Age,Age_Group,Gender,Grid_Magnitude))
volmag.left <- bind_cols(filter(strucdata,Side=="LeftEC"),select(gridmagav.left,Age,Age_Group,Gender,Grid_Magnitude))
volmag.both <- rbind(volmag.left,volmag.right)
ggplot(volmag.both,aes(Volume,Grid_Magnitude,colour=Side)) +
geom_jitter() +
geom_smooth(method=lm)
lm.volmag <- lm(data=volmag.both,Grid_Magnitude~Volume + Side + Volume:Side)
anova(lm.volmag)
lm.volmag.right <- lm(data=volmag.right,Grid_Magnitude~Volume)
anova(lm.volmag.right)
lm.volmag.left <- lm(data=volmag.left,Grid_Magnitude~Volume)
anova(lm.volmag.left)
voxels.gridCAT.left <- tgridtaskin %>% mutate(nVoxels_leftEC=Voxels_ROI_LH-Voxels_NaN_LH)
voxels.gridCAT.right <- tgridtaskin %>% mutate(nVoxels_rightEC=Voxels_ROI_RH-Voxels_NaN_RH)
volmag.left[,14] <- select(voxels.gridCAT.left,nVoxels_leftEC)
volmag.right[,14] <- select(voxels.gridCAT.right,nVoxels_rightEC)
nvoxelmag.both <- bind_cols(volmag.left[,c(1,10,12,14)],volmag.right[,14])
nvoxelmag.both
ggplot(volmag.right,aes(nVoxels_rightEC,Grid_Magnitude,colour=Age)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="Association of gridCAT voxel number in right EC with magnitude and with age")
lm.nvoxelsage.right <- lm(data=volmag.right,Grid_Magnitude~nVoxels_rightEC + Age + nVoxels_rightEC:Age)
anova(lm.nvoxelsage.right)
ggplot(volmag.left,aes(nVoxels_leftEC,Grid_Magnitude,colour=Age)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="Association of gridCAT voxel number in left EC with magnitude and with age")
lm.nvoxelsage.left <- lm(data=volmag.left,Grid_Magnitude~nVoxels_leftEC + Age + nVoxels_leftEC:Age)
anova(lm.nvoxelsage.left)
lm.volage <- lm(data=volmag.both,Volume~Age + Side + Side:Age)
anova(lm.volage)
lm.nvoxelsleft.age <- lm(data=volmag.left,nVoxels_leftEC~Age)
anova(lm.nvoxelsleft.age)
lm.nvoxelsright.age <- lm(data=volmag.right,nVoxels_rightEC~Age)
anova(lm.nvoxelsright.age)
t.test(volmag.right$nVoxels_rightEC,volmag.left$nVoxels_leftEC,alternative = "two.sided",var.equal=TRUE)
ggplot(volmag.both,aes(Mean_tSNR,Grid_Magnitude,colour=Side)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="Association of mean tSNR with average grid magnitude")
lm.tsnrmag <- lm(data=volmag.both,Grid_Magnitude~Mean_tSNR + Mean_tSNR:Age + Mean_tSNR:Side)
anova(lm.tsnrmag)
lm.tSNRage <- lm(data=volmag.both,Mean_tSNR~Age + Side + Age:Side)
anova(lm.tSNRage)
ggplot(volmag.both,aes(Age,Mean_tSNR,colour=Side)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title = "Trend association of tSNR with Age")
ggplot(volmag.both,aes(Mean_tSNR,fill=Side)) +
geom_histogram(position="dodge",binwidth=2)
t.test(Mean_tSNR~Side,data=volmag.both,alternative="two.sided",var.equal=TRUE)
pct_corr <- select(tgridtaskin,contains("Pct")) %>% gather(key="Run",value="Pct_Corr",starts_with("Pct"))
meanRT <- select(tgridtaskin,contains("Mean")) %>% gather(key="Run",value="Mean_RT",starts_with("Mean"))
behav_mag_rightEC <- bind_cols(gridmag.runs04,pct_corr,meanRT)
lm.pctCorr.right <- lm(data=behav_mag_rightEC,Grid_Magnitude~Pct_Corr + Run + Pct_Corr:Run)
anova(lm.pctCorr.right)
ggplot(behav_mag_rightEC,aes(Pct_Corr,Grid_Magnitude,colour=Run)) +
geom_jitter() +
geom_smooth(method=lm,alpha=0.2) +
facet_wrap(~Age_Group) +
labs(title = "Association of object location memory accuracy and grid magnitude per run")
ggplot(behav_mag_rightEC, aes(Run1,Pct_Corr,fill=Age_Group)) +
geom_boxplot(posiiton="dodge",alpha=0.6) +
geom_point(aes(fill=Age_Group),size=3,shape=21,position=position_jitterdodge(0.2)) +
labs(title="Mean accuracy of object location memory grid cell task by age group and run")
lm.meanRT.right <- lm(data=behav_mag_rightEC,Grid_Magnitude~Mean_RT + Run + Mean_RT:Run)
anova(lm.meanRT.right)
ggplot(behav_mag_rightEC,aes(Mean_RT,Grid_Magnitude,colour=Run)) +
geom_jitter() +
geom_smooth(method=lm,alpha=0.2) +
labs(title = "Association of reaction time during object location task and \n grid magnitude per run")
ggplot(behav_mag_rightEC, aes(Run,Mean_RT,fill=Age_Group)) +
geom_boxplot(posiiton="dodge",alpha=0.6) +
geom_point(aes(fill=Age_Group),size=3,shape=21,position=position_jitterdodge(0.2))
labs(title="Mean reaction time during object location memory grid cell task by age group and run")
tgridcodethresh = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_threshX_totalresults_v2.csv');
######### TIDY DATA #############
# recode subject to factor
tgridcodethresh[,1] <- lapply(tgridcodethresh[,1],factor)
tgridcodethresh <- tgridcodethresh[-8,]
# recode age cont to cat in tgridcodein + rmeove subject 29358
#tgridcodethresh2 <- tgridcodethresh[-8] %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# get magnitude from thresh models
gridthresh.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcodethresh,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridthresh.mag.sep <- separate(gridthresh.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
# make threshold tibble
threshmodels.both <- rbind(filter(gridthresh.mag.sep,Model=="thresh02"),filter(gridthresh.mag.sep,Model=="thresh03"),gridmagav.01,gridmag.runs01)
threshmodels.right <- rbind(filter(gridthresh.mag.sep,Model=="thresh05"),gridmagav.04,gridmag.runs04)
threshmodels.left <- rbind(filter(gridthresh.mag.sep,Model=="thresh04"),gridmagav.03,gridmag.runs03)
ggplot(threshmodels.both, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("o.4 threshold","0.7 threshold","0.1 threshold")) +
labs(title = "Grid magnitude across different thresholds for bilateral EC") +
facet_wrap(~Age_Group)
ggplot(threshmodels.left, aes(Model,Grid_Magnitude,fill = Run,colour=Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=2,shape=21) +
labs(title = "Grid magnitude across different thresholds for left EC") +
scale_x_discrete(labels=c("o.4 threshold","0.7 threshold")) +
facet_wrap(~Age_Group)
ggplot(threshmodels.right, aes(Model,Grid_Magnitude,fill = Run,colour=Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.6) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=2,shape=21) +
labs(title = "Grid magnitude across different thresholds for right EC") +
scale_x_discrete(labels=c("o.4 threshold","0.7 threshold")) +
facet_wrap(~Age_Group)
tgridcoderegress = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_regressX_totalresults_v2.csv');
######### TIDY DATA #############
# recode subject to factor
tgridcoderegress[,1] <- lapply(tgridcoderegress[,1],factor)
tgridcoderegress <- tgridcoderegress[-8,]
# recode age cont to cat in tgridcodein + rmeove subject 29358
#tgridcodethresh2 <- tgridcodethresh[-8] %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# get magnitude from thresh models
gridregress.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcoderegress,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridregress.mag.sep <- separate(gridregress.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
gridregress.mag.right <- rbind(filter(gridregress.mag.sep,Model=="regress02"),gridmag.runs04,gridmagav.04)
gridregress.mag.left <- rbind(filter(gridregress.mag.sep,Model=="regress03"),gridmag.runs03,gridmagav.03)
ggplot(gridregress.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("aligned_misaligned","parametric")) +
labs(title = "Grid magnitude across different grid event regressors, right EC") +
facet_wrap(~Age_Group)
ggplot(gridregress.mag.left, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("aligned_misaligned","parametric")) +
labs(title = "Grid magnitude across different grid event regressors, left EC") +
facet_wrap(~Age_Group)
tgridcodemask = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_pmECX_totalresults_v2.csv');
tgridcodemask[,1] <- lapply(tgridcodemask[,1],factor)
tgridcodemask <- tgridcodemask[-8,]
View(tgridcodemask)
gridmask.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcodemask,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmask.mag.sep <- separate(gridmask.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
gridmask.mag.right <- rbind(filter(gridmask.mag.sep,Model=="regress02"),gridmag.runs04,gridmagav.04)
gridmask.mag.left <- rbind(filter(gridmask.mag.sep,Model=="regress03"),gridmag.runs03,gridmagav.03)
View(gridmask.mag.right)
View(gridregress.mag)
View(gridmask.mag.sep)
View(gridmask.mag)
gridmask.mag.right <- rbind(filter(gridmask.mag.sep,Model=="pmEC01"),gridmag.runs04,gridmagav.04)
gridmask.mag.left <- rbind(filter(gridmask.mag.sep,Model=="pmEC02"),gridmag.runs03,gridmagav.03)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
#scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.left, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks: LEFT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
tgridcodemask = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_pmECX_totalresults_v2.csv');
tgridcodemask[,1] <- lapply(tgridcodemask[,1],factor)
tgridcodemask <- tgridcodemask[-8,]
gridmask.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcodemask,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmask.mag.sep <- separate(gridmask.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
gridmask.mag.right <- rbind(filter(gridmask.mag.sep,Model=="pmEC01"),filter(gridmask.mag.sep,Model=="pmEC03"),gridmag.runs04,gridmagav.04)
gridmask.mag.left <- rbind(filter(gridmask.mag.sep,Model=="pmEC02"),filter(gridmask.mag.sep,Model=="pmEC04"),gridmag.runs03,gridmagav.03)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
#scale_x_discrete(labels=c("Whole EC","Postero-medial EC","Antero-lateral EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC","Antero-lateral EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","pm-EC","al-EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.left, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","pm-EC","al-EC")) +
labs(title = "Grid magnitude across different EC masks: LEFT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
