facet_grid(~Age_Group,scales="free_x")
ggplot(gridmag.runs04, aes(y=Grid_Magnitude,x=Subject,fill = Run)) +
geom_col(position=position_dodge()) +
labs(title = "Individual subjects' grid magnitude for Model 04 Right \n") +
facet_wrap(~Age_Group,scales="free_x")
grid.magv2.runs <- grid.magv2.sep %>% filter(Run != "allRuns")
right <- c("out04","outw10","outy11")
left <- c("out03","out08","out09")
grid.magv2.runsLR <- grid.magv2.runs %>% mutate(Side = factor(case_when(Model %in% right ~ "RightEC", Model %in% left ~ "LeftEC")))
ggplot(grid.magv2.runsLR, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(position = position_dodge()) +
facet_wrap(~Side,scales = "free_x") +
labs(title = "Effect of model on magnitude for left and right EC, all subjects \n")
grid.magavv2.model <- grid.magv2.sep %>% filter(Run == "allRuns")
grid.magavv2.model.right <- grid.magavv2.model %>%  mutate(Side = factor(case_when(Model %in% right ~ "RightEC", Model %in% left ~ "LeftEC"))) %>% filter(Side == "RightEC")
lm.grid.magavv2.model.right<- lm(data = grid.magavv2.model.right,Grid_Magnitude~Model + Age + Model:Age)
anova(lm.grid.magavv2.model.right)
grid.magav2.right.ttest.4v10 <- filter(grid.magavv2.model.right,Model != "outy11")
t.test(Grid_Magnitude~Model,data=grid.magav2.right.ttest.4v10,alternative="two.sided",var.equal=TRUE)
grid.magav2.right.ttest.4v11 <- filter(grid.magavv2.model.right,Model != "outw10")
t.test(Grid_Magnitude~Model,data=grid.magav2.right.ttest.4v11,alternative="two.sided",var.equal=TRUE)
ggplot(grid.magavv2.model.right,aes(Age,Grid_Magnitude)) +
geom_jitter() +
facet_wrap(~Model) +
geom_smooth(method=lm) +
labs(title="Right EC grid-magnitude relationships with age for main and control models")
grid.magavv2.model.left <- grid.magavv2.model %>%  mutate(Side = factor(case_when(Model %in% right ~ "RightEC", Model %in% left ~ "LeftEC"))) %>% filter(Side == "LeftEC")
lm.grid.magavv2.model.left<- lm(data = grid.magavv2.model.left,Grid_Magnitude~Model + Age + Model:Age)
anova(lm.grid.magavv2.model.left)
ggplot(grid.magavv2.model.left,aes(Age,Grid_Magnitude)) +
geom_jitter() +
facet_wrap(~Model) +
geom_smooth(method=lm) +
labs(title="Left EC grid-magnitude relationships with age for main and control models")
grid.tstab.runs <- filter(grid.tStability.sep, !grepl("allRunsAvg",RunComparison))
ggplot(grid.tstab.runs, aes(Model,Grid_tStability,fill = RunComparison)) +
geom_boxplot(position = position_dodge()) +
labs(title = "% of voxels stable between runs, all subjects for each model \n")
lm.tstab.runs <- lm(data = grid.tstab.runs, Grid_tStability~Model + RunComparison + Model:RunComparison)
anova(lm.tstab.runs)
ggplot(grid.tstab.runs, aes(Model,Grid_tStability,fill = RunComparison)) +
geom_boxplot(position = position_dodge()) +
facet_wrap(~Age_Group)
grid.tstab.runs01 <- grid.tstab.runs %>% filter(Model == "out01")
lm.gridtstab.allruns.age.01 <- lm(data = grid.tstab.runs01, Grid_tStability~Age)
anova(lm.gridtstab.allruns.age.01)
grid.tstab.runs03 <- filter(grid.tstab.runs, Model == "out03")
lm.gridtstab.allruns.age.03 <- lm(data= grid.tstab.runs03, Grid_tStability~Age)
anova(lm.gridtstab.allruns.age.03)
grid.tstab.runs04 <- filter(grid.tstab.runs, Model == "out04")
lm.gridtstab.allruns.age.04 <- lm(data = grid.tstab.runs04, Grid_tStability~Age)
anova(lm.gridtstab.allruns.age.04)
grid.tstab.main <- rbind(grid.tstab.runs01,grid.tstab.runs03,grid.tstab.runs04)
ggplot(grid.tstab.main,aes(Age,Grid_tStability,colour=RunComparison)) +
geom_jitter() +
geom_smooth(method = lm,alpha=0.25) +
facet_wrap(~Model) +
labs(title="Temporal stability significantly associated with age for right EC only (04)")
# make new column coding for significant p value or not
freq.sStability.p <- grid.sStability.p.sep %>%
filter(Run == "allRunsAvg") %>%
mutate(FreqSig=cut(Grid_sStabilityP,breaks = c(-Inf, 0.05, Inf), labels = c("<0.05",">0.05")))
ggplot(freq.sStability.p, aes(FreqSig, ..count..)) +
geom_bar(aes(fill = Model), position = "dodge") +
facet_wrap(~Age_Group) +
labs(title = "Frequency of subjects showing significant non-uniformity split by age\n")
grid.sStability.z.av <- filter(grid.sStability.z.sep, Run == "allRunsAvg")
ggplot(grid.sStability.z.av,aes(Age,Grid_sStabilityZ)) +
geom_jitter() +
geom_smooth(method=lm,alpha=0.2) +
facet_wrap(~Model) +
labs(title = "Rayleigh Z value association with age per model")
lm.gridsStab.age.model <- lm(data=grid.sStability.z.av,Grid_sStabilityZ~Age + Model + Age:Model)
anova(lm.gridsStab.age.model)
strucdata
tgridtaskin <- tgridtaskin[-8,]
tgridtaskin
gridmagav.right <- filter(grid.magavv2.model,Model=="out04")
gridmagav.left <- filter(grid.magavv2.model,Model=="out03")
volmagall <- left_join(strucdata,grid.magv2.runsLR,by = c("Subject","Side"))
volmag.right <- bind_cols(filter(strucdata,Side=="RightEC"),select(gridmagav.right,Age,Age_Group,Gender,Grid_Magnitude))
volmag.left <- bind_cols(filter(strucdata,Side=="LeftEC"),select(gridmagav.left,Age,Age_Group,Gender,Grid_Magnitude))
volmag.both <- rbind(volmag.left,volmag.right)
ggplot(volmag.both,aes(Volume,Grid_Magnitude,colour=Side)) +
geom_jitter() +
geom_smooth(method=lm)
lm.volmag <- lm(data=volmag.both,Grid_Magnitude~Volume + Side + Volume:Side)
anova(lm.volmag)
lm.volmag.right <- lm(data=volmag.right,Grid_Magnitude~Volume)
anova(lm.volmag.right)
lm.volmag.left <- lm(data=volmag.left,Grid_Magnitude~Volume)
anova(lm.volmag.left)
voxels.gridCAT.left <- tgridtaskin %>% mutate(nVoxels_leftEC=Voxels_ROI_LH-Voxels_NaN_LH)
voxels.gridCAT.right <- tgridtaskin %>% mutate(nVoxels_rightEC=Voxels_ROI_RH-Voxels_NaN_RH)
volmag.left[,14] <- select(voxels.gridCAT.left,nVoxels_leftEC)
volmag.right[,14] <- select(voxels.gridCAT.right,nVoxels_rightEC)
nvoxelmag.both <- bind_cols(volmag.left[,c(1,10,12,14)],volmag.right[,14])
nvoxelmag.both
ggplot(volmag.right,aes(nVoxels_rightEC,Grid_Magnitude,colour=Age)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="Association of gridCAT voxel number in right EC with magnitude and with age")
lm.nvoxelsage.right <- lm(data=volmag.right,Grid_Magnitude~nVoxels_rightEC + Age + nVoxels_rightEC:Age)
anova(lm.nvoxelsage.right)
ggplot(volmag.left,aes(nVoxels_leftEC,Grid_Magnitude,colour=Age)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="Association of gridCAT voxel number in left EC with magnitude and with age")
lm.nvoxelsage.left <- lm(data=volmag.left,Grid_Magnitude~nVoxels_leftEC + Age + nVoxels_leftEC:Age)
anova(lm.nvoxelsage.left)
lm.volage <- lm(data=volmag.both,Volume~Age + Side + Side:Age)
anova(lm.volage)
lm.nvoxelsleft.age <- lm(data=volmag.left,nVoxels_leftEC~Age)
anova(lm.nvoxelsleft.age)
lm.nvoxelsright.age <- lm(data=volmag.right,nVoxels_rightEC~Age)
anova(lm.nvoxelsright.age)
t.test(volmag.right$nVoxels_rightEC,volmag.left$nVoxels_leftEC,alternative = "two.sided",var.equal=TRUE)
ggplot(volmag.both,aes(Mean_tSNR,Grid_Magnitude,colour=Side)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title="Association of mean tSNR with average grid magnitude")
lm.tsnrmag <- lm(data=volmag.both,Grid_Magnitude~Mean_tSNR + Mean_tSNR:Age + Mean_tSNR:Side)
anova(lm.tsnrmag)
lm.tSNRage <- lm(data=volmag.both,Mean_tSNR~Age + Side + Age:Side)
anova(lm.tSNRage)
ggplot(volmag.both,aes(Age,Mean_tSNR,colour=Side)) +
geom_jitter() +
geom_smooth(method=lm) +
labs(title = "Trend association of tSNR with Age")
ggplot(volmag.both,aes(Mean_tSNR,fill=Side)) +
geom_histogram(position="dodge",binwidth=2)
t.test(Mean_tSNR~Side,data=volmag.both,alternative="two.sided",var.equal=TRUE)
pct_corr <- select(tgridtaskin,contains("Pct")) %>% gather(key="Run",value="Pct_Corr",starts_with("Pct"))
meanRT <- select(tgridtaskin,contains("Mean")) %>% gather(key="Run",value="Mean_RT",starts_with("Mean"))
behav_mag_rightEC <- bind_cols(gridmag.runs04,pct_corr,meanRT)
lm.pctCorr.right <- lm(data=behav_mag_rightEC,Grid_Magnitude~Pct_Corr + Run + Pct_Corr:Run)
anova(lm.pctCorr.right)
ggplot(behav_mag_rightEC,aes(Pct_Corr,Grid_Magnitude,colour=Run)) +
geom_jitter() +
geom_smooth(method=lm,alpha=0.2) +
facet_wrap(~Age_Group) +
labs(title = "Association of object location memory accuracy and grid magnitude per run")
ggplot(behav_mag_rightEC, aes(Run1,Pct_Corr,fill=Age_Group)) +
geom_boxplot(posiiton="dodge",alpha=0.6) +
geom_point(aes(fill=Age_Group),size=3,shape=21,position=position_jitterdodge(0.2)) +
labs(title="Mean accuracy of object location memory grid cell task by age group and run")
lm.meanRT.right <- lm(data=behav_mag_rightEC,Grid_Magnitude~Mean_RT + Run + Mean_RT:Run)
anova(lm.meanRT.right)
ggplot(behav_mag_rightEC,aes(Mean_RT,Grid_Magnitude,colour=Run)) +
geom_jitter() +
geom_smooth(method=lm,alpha=0.2) +
labs(title = "Association of reaction time during object location task and \n grid magnitude per run")
ggplot(behav_mag_rightEC, aes(Run,Mean_RT,fill=Age_Group)) +
geom_boxplot(posiiton="dodge",alpha=0.6) +
geom_point(aes(fill=Age_Group),size=3,shape=21,position=position_jitterdodge(0.2))
labs(title="Mean reaction time during object location memory grid cell task by age group and run")
tgridcodethresh = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_threshX_totalresults_v2.csv');
######### TIDY DATA #############
# recode subject to factor
tgridcodethresh[,1] <- lapply(tgridcodethresh[,1],factor)
tgridcodethresh <- tgridcodethresh[-8,]
# recode age cont to cat in tgridcodein + rmeove subject 29358
#tgridcodethresh2 <- tgridcodethresh[-8] %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# get magnitude from thresh models
gridthresh.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcodethresh,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridthresh.mag.sep <- separate(gridthresh.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
# make threshold tibble
threshmodels.both <- rbind(filter(gridthresh.mag.sep,Model=="thresh02"),filter(gridthresh.mag.sep,Model=="thresh03"),gridmagav.01,gridmag.runs01)
threshmodels.right <- rbind(filter(gridthresh.mag.sep,Model=="thresh05"),gridmagav.04,gridmag.runs04)
threshmodels.left <- rbind(filter(gridthresh.mag.sep,Model=="thresh04"),gridmagav.03,gridmag.runs03)
ggplot(threshmodels.both, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("o.4 threshold","0.7 threshold","0.1 threshold")) +
labs(title = "Grid magnitude across different thresholds for bilateral EC") +
facet_wrap(~Age_Group)
ggplot(threshmodels.left, aes(Model,Grid_Magnitude,fill = Run,colour=Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=2,shape=21) +
labs(title = "Grid magnitude across different thresholds for left EC") +
scale_x_discrete(labels=c("o.4 threshold","0.7 threshold")) +
facet_wrap(~Age_Group)
ggplot(threshmodels.right, aes(Model,Grid_Magnitude,fill = Run,colour=Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.6) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=2,shape=21) +
labs(title = "Grid magnitude across different thresholds for right EC") +
scale_x_discrete(labels=c("o.4 threshold","0.7 threshold")) +
facet_wrap(~Age_Group)
tgridcoderegress = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_regressX_totalresults_v2.csv');
######### TIDY DATA #############
# recode subject to factor
tgridcoderegress[,1] <- lapply(tgridcoderegress[,1],factor)
tgridcoderegress <- tgridcoderegress[-8,]
# recode age cont to cat in tgridcodein + rmeove subject 29358
#tgridcodethresh2 <- tgridcodethresh[-8] %>% mutate(Age_Group=cut(Age,breaks = c(-Inf, 30, Inf), labels = c("Young","Old")))
# get magnitude from thresh models
gridregress.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcoderegress,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridregress.mag.sep <- separate(gridregress.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
gridregress.mag.right <- rbind(filter(gridregress.mag.sep,Model=="regress02"),gridmag.runs04,gridmagav.04)
gridregress.mag.left <- rbind(filter(gridregress.mag.sep,Model=="regress03"),gridmag.runs03,gridmagav.03)
ggplot(gridregress.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("aligned_misaligned","parametric")) +
labs(title = "Grid magnitude across different grid event regressors, right EC") +
facet_wrap(~Age_Group)
ggplot(gridregress.mag.left, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("aligned_misaligned","parametric")) +
labs(title = "Grid magnitude across different grid event regressors, left EC") +
facet_wrap(~Age_Group)
tgridcodemask = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_pmECX_totalresults_v2.csv');
tgridcodemask[,1] <- lapply(tgridcodemask[,1],factor)
tgridcodemask <- tgridcodemask[-8,]
View(tgridcodemask)
gridmask.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcodemask,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmask.mag.sep <- separate(gridmask.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
gridmask.mag.right <- rbind(filter(gridmask.mag.sep,Model=="regress02"),gridmag.runs04,gridmagav.04)
gridmask.mag.left <- rbind(filter(gridmask.mag.sep,Model=="regress03"),gridmag.runs03,gridmagav.03)
View(gridmask.mag.right)
View(gridregress.mag)
View(gridmask.mag.sep)
View(gridmask.mag)
gridmask.mag.right <- rbind(filter(gridmask.mag.sep,Model=="pmEC01"),gridmag.runs04,gridmagav.04)
gridmask.mag.left <- rbind(filter(gridmask.mag.sep,Model=="pmEC02"),gridmag.runs03,gridmagav.03)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
#scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks, right EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.left, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC")) +
labs(title = "Grid magnitude across different EC masks: LEFT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
tgridcodemask = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/gridcellpilot/results/gridCAT_pmECX_totalresults_v2.csv');
tgridcodemask[,1] <- lapply(tgridcodemask[,1],factor)
tgridcodemask <- tgridcodemask[-8,]
gridmask.mag <- bind_cols(select(tgridcodeinv2,Subject,Age,Age_Group,Gender),select(tgridcodemask,starts_with("GCmagnitude"))) %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmask.mag.sep <- separate(gridmask.mag,Model,c(NA,"Run",NA,NA,"Model"),"_")
gridmask.mag.right <- rbind(filter(gridmask.mag.sep,Model=="pmEC01"),filter(gridmask.mag.sep,Model=="pmEC03"),gridmag.runs04,gridmagav.04)
gridmask.mag.left <- rbind(filter(gridmask.mag.sep,Model=="pmEC02"),filter(gridmask.mag.sep,Model=="pmEC04"),gridmag.runs03,gridmagav.03)
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
#scale_x_discrete(labels=c("Whole EC","Postero-medial EC","Antero-lateral EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","Postero-medial EC","Antero-lateral EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.right, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","pm-EC","al-EC")) +
labs(title = "Grid magnitude across different EC masks: RIGHT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
ggplot(gridmask.mag.left, aes(Model,Grid_Magnitude,fill = Run)) +
geom_boxplot(outlier.shape = NA, alpha=0.4) +
geom_point(aes(x=Model,fill=Run,colour=Run),position=position_jitterdodge(0.1),size=1,shape=21) +
scale_x_discrete(labels=c("Whole EC","pm-EC","al-EC")) +
labs(title = "Grid magnitude across different EC masks: LEFT EC") +
facet_wrap(~Age_Group) +
xlab("Mask")
?help_csv
?read_csv
# Stats on gridcode metrics
require(ggplot2)
require(tidyr)
# Stats on gridcode metrics
require(ggplot2)
library(tidyverse)
---
title: "GridCAT Mask Comparison"
author: "C Newton"
date: "2/19/2021"
output: html_document
---
knitr::opts_chunk$set(echo = TRUE)
# Stats on gridcode metrics
require(ggplot2)
library(tidyverse)
require(readxl)
require(RColorBrewer)
require(ggthemes)
require(RColorBrewer)
require(ggthemes)
require(lme4)
# load in data
gridOrig_in = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/results/$csv_result_files/gridCAT_final_X_results_meanOri.csv');
gridMaass_in = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/results/$csv_result_files/gridCAT_Maass_X_results.csv');
# tidy data
gridOrig_in[1] <- lapply(gridOrig_in[1],factor)
gridMaass_in[1] <- lapply(gridMaass_in[1],factor)
View(gridMaass_in)
View(gridOrig_in)
gridMaass_in = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/results/$csv_result_files/gridCAT_Maass_X_results.csv');
gridOrig_in[1] <- lapply(gridOrig_in[1],factor)
gridMaass_in[1] <- lapply(gridMaass_in[1],factor)
gridMaass_in
gridOrig_in
gridOrig_in[1,3] <- lapply(gridOrig_in[1,3],factor)
gridOrig_in[c(1,3)] <- lapply(gridOrig_in[c(1,3)],factor)
gridOrig_in[1 3] <- lapply(gridOrig_in[1 3],factor)
gridOrig_in[3] <- lapply(gridOrig_in[3],factor)
gridOrig_in
csvImport = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/results/gridCAT/gridCAT_X_results_global.csv')
csvImport[1] <- lapply(csvImport[1],factor)
gridmag.untidy <- csvImport %>% select(Subject,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag <- separate(gridmag.gather,Model,c(NA,"Run","ROI","Side","XFold"),"_")
View(csvImport)
View(gridmag.untidy)
View(gridmag.gather)
View(gridmag)
View(gridmag.gather)
gridmag.untidy <- gridOrig_in %>% select(Subject,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag <- separate(gridmag.gather,Model,c(NA,"Run","Side",NA,"Mask","ROI"),"_")
View(gridmag)
gridmag.untidy <- gridMaass_in %>% select(Subject,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.untidy <- gridOrig_in %>% select(Subject,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Orig <- separate(gridmag.gather,Model,c(NA,"Run","Side",NA,"Mask","ROI"),"_")
rm(gridmag.gather,gridmag.untidy)
gridmag.untidy <- gridMaass_in %>% select(Subject,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Maass <- separate(gridmag.gather,Model,c(NA,"Run","Side","ROI"),"_")
View(gridmag.Maass)
gridmag.Maass
gridmag.Maass %>% add_column(Mask = "Maass")
gridmag.Maass
gridmag.Maass %>% add_column(Mask = "Maass")
gridmag.Maass
gridmag.Maass <- gridmag.Maass %>% add_column(Mask = "Maass")
gridmag.Maass
View(gridmag.Orig)
girdmag.Orig <- gridmag.Orig %>% add_column(Mask = "Manual")
gridmag.Orig <- separate(gridmag.gather,Model,c(NA,"Run","Side",NA,NA,"ROI"),"_")
gridmag.untidy <- gridOrig_in %>% select(Subject,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Orig <- separate(gridmag.gather,Model,c(NA,"Run","Side",NA,NA,"ROI"),"_")
girdmag.Orig <- gridmag.Orig %>% add_column(Mask = "Manual")
gridmag.Orig <- gridmag.Orig %>% add_column(Mask = "Manual")
gridmag.Orig %in% separate(ROI,c("al","pm"))
separate(gridmag.Orig,ROI,c("al","pm"))
gridmag.Orig.main <- gridmag.Orig %>% filter(ROI %in% c("pmRight6","pmLeft6","alRight6","alLeft6"))
View(girdmag.Orig)
View(gridmag.Orig.main)
gridmag <- rbind(gridmag.Orig.main, gridmag.Maass)
View(gridmag)
gridmag
View(gridOrig_in)
gridmag.untidy <- gridOrig_in %>% select(Subject,Age,Gender,starts_with("GCmagnitude"))
View(gridmag.untidy)
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Orig <- separate(gridmag.gather,Model,c(NA,"Run","Side",NA,NA,"ROI"),"_")
gridmag.Orig <- gridmag.Orig %>% add_column(Mask = "Manual")
gridmag.Orig.main <- gridmag.Orig %>% filter(ROI %in% c("pmRight6","pmLeft6","alRight6","alLeft6"))
gridmag.untidy <- gridMaass_in %>% select(Subject,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Maass <- separate(gridmag.gather,Model,c(NA,"Run","Side","ROI"),"_")
rm(gridmag.gather,gridmag.untidy)
gridmag.Maass <- gridmag.Maass %>% add_column(Mask = "Maass")
gridmag <- rbind(gridmag.Orig.main, gridmag.Maass)
View(gridOrig_in)
cbind(gridMaass_in, gridOrig_in[ ,2:3])
gridMaass_in <- cbind(gridMaass_in,gridOrig_in[ ,2:3])
View(gridMaass_in)
gridOrig_in = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/results/$csv_result_files/gridCAT_final_X_results_meanOri.csv');
gridMaass_in = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/results/$csv_result_files/gridCAT_Maass_X_results.csv');
gridOrig_in[1] <- lapply(gridOrig_in[1],factor)
gridOrig_in[3] <- lapply(gridOrig_in[3],factor)
gridMaass_in[1] <- lapply(gridMaass_in[1],factor)
gridMaass_in <- cbind(gridMaass_in,gridOrig_in[ ,2:3])
# extract magnitude data from Orig for pm/al 6 fold
gridmag.untidy <- gridOrig_in %>% select(Subject,Age,Gender,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Orig <- separate(gridmag.gather,Model,c(NA,"Run","Side",NA,NA,"ROI"),"_")
gridmag.Orig <- gridmag.Orig %>% add_column(Mask = "Manual")
gridmag.Orig.main <- gridmag.Orig %>% filter(ROI %in% c("pmRight6","pmLeft6","alRight6","alLeft6"))
rm(gridmag.gather,gridmag.untidy)
# extract magntidue data from Maass
gridmag.untidy <- gridMaass_in %>% select(Subject,Age,Gender,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Maass <- separate(gridmag.gather,Model,c(NA,"Run","Side","ROI"),"_")
rm(gridmag.gather,gridmag.untidy)
gridmag.Maass <- gridmag.Maass %>% add_column(Mask = "Maass")
# combine Orig and Mag
gridmag <- rbind(gridmag.Orig.main, gridmag.Maass)
gridmag
cbind(gridMaass_in, gridOrig_in[ ,2:3])
as_factor(gridmag)
gridmag[ ,4:6]
parse_factor()
parse_factor(gridmag)
gridmag$Subject
gridmag$Run <- parse_factor(gridmag$Run)
gridmag
?lapply()
?modify_at()
gridmag %>% modify_if(is.character,as.factor)
gridmag <- gridmag %>% modify_if(is.character,as.factor)
gridmag
pd <- position_dodge(0.2)
View(gridmag)
gridmag.allrus <- gridmag %>% filter(Run %in% "allRuns")
gridmag.allruns <- gridmag %>% filter(Run %in% "allRuns")
View(gridmag.allruns)
ggplot(gridmag.allruns, aes(Side,Grid_Magnitude)) +
geom_boxplot(aes(fill=ROI),outlier.shape = NA,alpha=0.6, show.legend = TRUE) +
scale_fill_brewer(palette="YlGnBu")
ggplot(gridmag.allruns, aes(Side,Grid_Magnitude)) +
geom_boxplot(aes(fill=ROI),outlier.shape = NA,alpha=0.6, show.legend = TRUE) +
scale_fill_brewer(palette="YlGnBu") +
facet_wrap(~Mask)
ggplot(gridmag.allruns, aes(ROI,Grid_Magnitude)) +
geom_boxplot(outlier.shape = NA,alpha=0.6, show.legend = TRUE) +
scale_fill_brewer(palette="YlGnBu") +
facet_wrap(~Mask)
ggplot(gridmag.allruns, aes(ROI,Grid_Magnitude)) +
geom_boxplot(outlier.shape = NA,alpha=0.6, show.legend = TRUE) +
scale_fill_brewer(palette="YlGnBu") +
facet_wrap(~Mask,scales="free")
Side
ggplot(gridmag.allruns, aes(Side,Grid_Magnitude)) +
geom_boxplot(aes(fill=ROI),outlier.shape = NA,alpha=0.6, show.legend = TRUE) +
scale_fill_brewer(palette="YlGnBu") +
facet_wrap(~Mask)
knitr::opts_chunk$set(echo = TRUE)
# Stats on gridcode metrics
require(ggplot2)
library(tidyverse)
require(readxl)
require(RColorBrewer)
require(ggthemes)
require(RColorBrewer)
require(ggthemes)
require(lme4)
# load in data
gridOrig_in = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/results/$csv_result_files/gridCAT_final_X_results_meanOri.csv');
gridMaass_in = read_csv('/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/results/$csv_result_files/gridCAT_Maass_X_results.csv');
# add demographic data to Maass masks
gridMaass_in <- cbind(gridMaass_in,gridOrig_in[ ,2:3])
# extract magnitude data from Orig for pm/al 6 fold
gridmag.untidy <- gridOrig_in %>% select(Subject,Age,Gender,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Orig <- separate(gridmag.gather,Model,c(NA,"Run","Side",NA,NA,"ROI"),"_")
gridmag.Orig <- gridmag.Orig %>% add_column(Mask = "Manual")
gridmag.Orig.main <- gridmag.Orig %>% filter(ROI %in% c("pmRight6","pmLeft6","alRight6","alLeft6"))
rm(gridmag.gather,gridmag.untidy)
# extract magntidue data from Maass
gridmag.untidy <- gridMaass_in %>% select(Subject,Age,Gender,starts_with("GCmagnitude"))
gridmag.gather <- gridmag.untidy %>% gather(Model,Grid_Magnitude,starts_with("GCmag"))
gridmag.Maass <- separate(gridmag.gather,Model,c(NA,"Run","Side","ROI"),"_")
rm(gridmag.gather,gridmag.untidy)
gridmag.Maass <- gridmag.Maass %>% add_column(Mask = "Maass")
# combine Orig and Mag, make factors
gridmag <- rbind(gridmag.Orig.main, gridmag.Maass)
gridmag <- gridmag %>% modify_if(is.character,as.factor)
gridmag
pd <- position_dodge(0.2)
gridmag.allruns <- gridmag %>% filter(Run %in% "allRuns")
ggplot(gridmag.allruns, aes(Side,Grid_Magnitude)) +
geom_boxplot(aes(fill=ROI),outlier.shape = NA,alpha=0.6, show.legend = TRUE) +
scale_fill_brewer(palette="YlGnBu") +
facet_wrap(~Mask)
install.packages("fslr")
library("fslr", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.3")
fname <- '/lustre/scratch/wbic-beta/ccn30/ENCRYPT/fMRI/gridcellpilot/preprocessed_data/images/old_data/27734/topup_Run_1.nii'
img <- readNIfTI(fname)
?readNIfTI
img <- readNIfTI(fname,reorient=FALSE)
orthographic(img)
